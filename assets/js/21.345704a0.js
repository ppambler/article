(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{573:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"★同步与异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★同步与异步"}},[t._v("#")]),t._v(" ★同步与异步")]),t._v(" "),a("ul",[a("li",[t._v("同步（能直接拿到结果）\n"),a("ul",[a("li",[t._v("死等，不拿到结果不会离开")]),t._v(" "),a("li",[t._v("例如：医院挂号")])])]),t._v(" "),a("li",[t._v("异步（不能直接拿到结果）\n"),a("ul",[a("li",[t._v("取号后可以离开，不影响拿结果")]),t._v(" "),a("li",[t._v("每隔十分钟去问问店家（轮询）")]),t._v(" "),a("li",[t._v("店家电话通知（回调）")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("同步：等结果；异步：不等结果，之后透过回调拿到结果！")])]),t._v(" "),a("h3",{attrs:{id:"_1-异步举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-异步举例"}},[t._v("#")]),t._v(" 1）异步举例")]),t._v(" "),a("p",[t._v("JS 中请求到响应的时间大约几百毫秒到 1~2 秒")]),t._v(" "),a("ul",[a("li",[t._v("以 AJAX 为例\n"),a("ul",[a("li",[a("code",[t._v("request.send()")]),t._v(" 之后，并不能直接得到 "),a("code",[t._v("response")])]),t._v(" "),a("li",[t._v("必须等到 "),a("code",[t._v("readyState")]),t._v(" 变为 "),a("code",[t._v("4")]),t._v(" 后（下载完成），浏览器回调 "),a("code",[t._v("request.onreadystatechange")]),t._v(" 函数")]),t._v(" "),a("li",[t._v("才能得到 "),a("code",[t._v("request.response")])])])])]),t._v(" "),a("p",[t._v("这就好比，你在餐厅等位，不能马上入座，就先去逛街，等到餐厅有座服务员电话通知你，才能就座入席。")]),t._v(" "),a("blockquote",[a("p",[t._v("你要「餐厅位置」这个结果，但餐厅不能立刻给你，毕竟目前是满座的状态，于是你就继续去玩，玩够了，就等着餐厅打电话 call 你说「先生，你的位置在 "),a("code",[t._v("xxx")]),t._v(" 号！」 -> 为什么餐厅会知道你的电话号码？那是你留下来给餐厅的！")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/ppambler/blog-images/raw/master/images/image-20201203121251641.png",alt:"image-20201203121251641"}})]),t._v(" "),a("ul",[a("li",[t._v("回调 (callback)\n"),a("ul",[a("li",[t._v("写给自己用的函数，不是回调")]),t._v(" "),a("li",[t._v("写给别人用的函数，才是回调")]),t._v(" "),a("li",[t._v("比如预留电话这个函数，不是给自己留的，是给店家留的")]),t._v(" "),a("li",[a("code",[t._v("request.onreadystatechange")]),t._v(" 就是写给浏览器调用的")]),t._v(" "),a("li",[t._v("告诉浏览器回头调用一下这个函数")])])])]),t._v(" "),a("p",[t._v("写了自己不调用，来给别人（回头）调用的函数，就是回调函数。")]),t._v(" "),a("blockquote",[a("p",[t._v("如果回调函数是 "),a("code",[t._v("call")]),t._v("这个函数，那么这个函数会等到有「餐位」这个结果之后，才会"),a("code",[t._v("push")]),t._v("到任务队列里边去，等"),a("code",[t._v("stack")]),t._v("清空之后，事件循环才会按顺序"),a("code",[t._v("push")]),t._v("这个"),a("code",[t._v("call")]),t._v("函数到"),a("code",[t._v("stack")]),t._v("里边交给 JS 引擎去解析执行！ -> 说白了，"),a("code",[t._v("call")]),t._v("能被叫做回调函数，那是因为它经历了一段特殊的历程，才会被调用！ -> 再简单来说，我走了，又回来了才会被执行，而不是我不走，我就待着执行就好了！")])]),t._v(" "),a("h3",{attrs:{id:"_2-回调举例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-回调举例"}},[t._v("#")]),t._v(" 2）回调举例")]),t._v(" "),a("p",[t._v("把函数 1 给另一个函数 2")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[t._v("分析：")]),t._v(" "),a("ul",[a("li",[t._v("f1 没有被直接调用")]),t._v(" "),a("li",[t._v("f1 被传给了 f2")]),t._v(" "),a("li",[t._v("f2 调用了 f1")]),t._v(" "),a("li",[t._v("因此 f1 就是我给 f2 写的函数，即回调函数")])]),t._v(" "),a("h2",{attrs:{id:"★异步和回调的关系"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★异步和回调的关系"}},[t._v("#")]),t._v(" ★异步和回调的关系")]),t._v(" "),a("ul",[a("li",[t._v("关联\n"),a("ul",[a("li",[t._v("异步任务需要在得到结果时通知 JS 来拿结果")]),t._v(" "),a("li",[t._v("可以让 JS 留一个函数地址（电话号码）给浏览器")]),t._v(" "),a("li",[t._v("异步任务完成时浏览器调用该函数地址即可（拨打电话）")]),t._v(" "),a("li",[t._v("同时把结果作为参数传给该函数（电话里说有座位了过来吧）")]),t._v(" "),a("li",[t._v("该函数是我写给浏览器调用的，因此是回调函数")])])]),t._v(" "),a("li",[t._v("区别\n"),a("ul",[a("li",[t._v("异步任务需要用回调函数来通知结果")]),t._v(" "),a("li",[t._v("异步任务常用回调，但不一定用回调，还可以用轮询")]),t._v(" "),a("li",[t._v("回调函数也不一定只用在异步任务里，也可以用在同步任务")]),t._v(" "),a("li",[a("code",[t._v("array.forEach(n=>console.log(n))")]),t._v("就是同步回调")])])])]),t._v(" "),a("blockquote",[a("p",[t._v("什么叫任务？完成一件事就是你的任务！")])]),t._v(" "),a("h2",{attrs:{id:"★如何判断同步异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★如何判断同步异步"}},[t._v("#")]),t._v(" ★如何判断同步异步")]),t._v(" "),a("ul",[a("li",[t._v("若一个函数的返回值处于以下三项内部，则该函数就是异步函数：\n"),a("ul",[a("li",[t._v("setTimeout")]),t._v(" "),a("li",[t._v("AJAX（即 XMLHttpRequest）")]),t._v(" "),a("li",[t._v("addEventListener")]),t._v(" "),a("li",[t._v("其他异步 API 另行说明")])])])]),t._v(" "),a("p",[t._v("虽然 AJAX 可以设置为同步（open 第三个参数），但是这样页面会在请求期间卡住（智障才同步）。")]),t._v(" "),a("blockquote",[a("p",[t._v("文字，还是比较抽象的，看代码比较好理解 -> 什么是色情？不知道，但我看了这个东西就知道这是不是色情了……")])]),t._v(" "),a("h3",{attrs:{id:"_1-举例分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-举例分析"}},[t._v("#")]),t._v(" 1）举例分析")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("floor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return underfined")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br")])]),a("p",[a("code",[t._v("Math.random")]),t._v(" 用于生成一个 "),a("code",[t._v("[0, 1)")]),t._v(" 的随机数，通过与 "),a("code",[t._v("6")]),t._v(" 相乘得到一个范围在 "),a("code",[t._v("[0, 1*6)")]),t._v(" 的随机数，"),a("code",[t._v("Math.floor")]),t._v(" 向下取整后加 "),a("code",[t._v("1")]),t._v("，即可得到范围 "),a("code",[t._v("[1,6]")]),t._v(" 的随机整数")]),t._v(" "),a("p",[t._v("分析：")]),t._v(" "),a("ul",[a("li",[t._v("若函数中没有写返回值，则默认返回值就是"),a("code",[t._v("undefined")])]),t._v(" "),a("li",[t._v("摇骰子函数调用的箭头函数的返回值是真正的结果")]),t._v(" "),a("li",[t._v("因此这是一个异步任务")])]),t._v(" "),a("blockquote",[a("p",[t._v("我是第一次学到这样分析一个函数是否是异步任务的！")]),t._v(" "),a("p",[t._v("如果把箭头函数抽出来为一个具名函数，作为"),a("code",[t._v("摇骰子")]),t._v("这个函数的参数传入，那么"),a("code",[t._v("摇骰子")]),t._v("就更像是一个异步任务了呀！")])]),t._v(" "),a("p",[t._v("💡：如何拿到异步的结果？")]),t._v(" "),a("p",[t._v("我们这样做：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("floor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// return underfined")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" n "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// undefined")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("显然无法拿到")]),t._v(" "),a("p",[t._v("但我们可以用回调完成这件事。写个回调函数 f1，将 f1 作为参数传给摇骰子，然后在摇骰子函数得到结果后，将结果作为参数传给 f1：")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("floor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("f1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("x")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("f1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("p",[t._v("简化为箭头函数：")]),t._v(" "),a("blockquote",[a("p",[t._v("由于 f1 声明后只用了一次，因此可以用匿名函数或箭头函数简化")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setTimeout")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("floor")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Math"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("random")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("x")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 再简化为")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("摇骰子")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("log"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果参数不相等，就不能这样简化")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h2",{attrs:{id:"★小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★小结"}},[t._v("#")]),t._v(" ★小结")]),t._v(" "),a("ul",[a("li",[t._v("异步任务拿不到结果")]),t._v(" "),a("li",[t._v("于是传一个回调函数给异步任务")]),t._v(" "),a("li",[t._v("在异步任务完成时调用回调函数")]),t._v(" "),a("li",[t._v("调用时将完成结果作为回调函数的参数")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/ppambler/blog-images/raw/master/images/image-20201203164114630.png",alt:"image-20201203164114630"}})]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("饭店")]),t._v("函数是异步任务，我们传了一个"),a("code",[t._v("callMe")]),t._v("给异步任务，异步任务完成时，也就是"),a("code",[t._v("seTimeout")]),t._v("时间到了，会把传给定时器的箭头函数扔到任务队列里边去，等 Stack 空空如也的时候，会把箭头函数 "),a("code",[t._v("push")]),t._v(" 到 "),a("code",[t._v("callStack")]),t._v("里边执行 -> 执行"),a("code",[t._v("callMe")])])]),t._v(" "),a("p",[t._v("一个疑问：所谓的异步任务完成，指的是已经把箭头函数推送到调用栈执行了？还是说把箭头函数扔到任务队列里边去就算完成了？")]),t._v(" "),a("p",[t._v("按照个人的理解：箭头函数到任务队列里边了，意味着异步任务已经完成了，相当于是「饭店已经有空座位了，只是还没打电话，因为不太确定客人是否有空，比如客人还在做着某些重要的事儿……」，客人通知任务队列说「我此刻无事可干」，于是饭店就会打电话给客人说「有座位了！」")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("Stack")]),t._v("清空后，浏览器会轮询任务队列说「任务完成了吗？」，如果完成了，会"),a("code",[t._v("push")]),t._v("一个"),a("code",[t._v("callback")]),t._v("到"),a("code",[t._v("Stack")]),t._v("里边去执行！")])]),t._v(" "),a("h2",{attrs:{id:"★如果异步的结果是成功或失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★如果异步的结果是成功或失败"}},[t._v("#")]),t._v(" ★如果异步的结果是成功或失败")]),t._v(" "),a("h3",{attrs:{id:"_1-方法一-回调函数接收两个参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-方法一-回调函数接收两个参数"}},[t._v("#")]),t._v(" 1）方法一：回调函数接收两个参数")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("fs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("readFileSync")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./1.txt'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" data")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("error"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'失败'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("blockquote",[a("p",[t._v("把第二个参数看成是"),a("code",[t._v("callMe")]),t._v("，"),a("code",[t._v("readFileSync")]),t._v("内部的实现会这样调用的："),a("code",[t._v("callMe(error,data)")])])]),t._v(" "),a("h3",{attrs:{id:"_2-方法二-使用两个回调函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-方法二-使用两个回调函数"}},[t._v("#")]),t._v(" 2）方法二：使用两个回调函数")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 接收一个成功回调函数，再接收一个失败回调函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/1.json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("error")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 接收一个对象，对象中有两个 key 分别表示成功和失败的回调函数")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/1.json'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fail")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br")])]),a("h3",{attrs:{id:"_3-不足之处"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-不足之处"}},[t._v("#")]),t._v(" 3）不足之处")]),t._v(" "),a("p",[t._v("面试常考："),a("strong",[t._v("为什么用 Promise？")]),t._v(" （三点）")]),t._v(" "),a("ol",[a("li",[t._v("不规范，成功和失败回调函数的名称五花八门（success+error, success+fail, done+fail）")]),t._v(" "),a("li",[t._v("容易出现回调地狱，代码可读性差")]),t._v(" "),a("li",[t._v("难以进行错误处理")])]),t._v(" "),a("p",[t._v("如同波动拳 (Hadoken) 一般的回调地狱（Callback Hell）：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/ppambler/blog-images/raw/master/images/image-20201203172015154.png",alt:"image-20201203172015154"}})]),t._v(" "),a("p",[t._v("💡：如何解决？")]),t._v(" "),a("ul",[a("li",[t._v("规范回调函数的名称和顺序")]),t._v(" "),a("li",[t._v("拒绝回调地狱")]),t._v(" "),a("li",[t._v("让捕获错误更方便")])]),t._v(" "),a("p",[t._v("为此，前端程序员开始翻书查资料借鉴后端知识：")]),t._v(" "),a("p",[t._v("1976 年，Daniel P. Friedman 和 David Wise 提出了 Promise 思想，后人基于此发明了 Future、Delay、Deferred 等。前端结合 Promise 和 JS，制订了 "),a("a",{attrs:{href:"https://www.ituring.com.cn/article/66566",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promise/A+规范"),a("OutboundLink")],1),t._v("，该规范中详细描述了 Promise 的原理和使用方法。")]),t._v(" "),a("h2",{attrs:{id:"★promise-以-ajax-封装为例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★promise-以-ajax-封装为例"}},[t._v("#")]),t._v(" ★Promise：以 AJAX 封装为例")]),t._v(" "),a("h3",{attrs:{id:"_1-老-jquery-写法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-老-jquery-写法"}},[t._v("#")]),t._v(" 1）老 jQuery 写法")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ajax")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("success"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" fail"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 析构赋值")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const success = options.success")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// const fail = options.fail")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fail")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/xxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("success")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("fail")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" status")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 两种不同的函数缩写")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("h3",{attrs:{id:"_2-promise-写法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-promise-写法"}},[t._v("#")]),t._v(" 2）Promise 写法")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("ajax")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Promise")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("resolve"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" request "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("XMLHttpRequest")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("method"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" url"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("onreadystatechange")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("readyState"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("response"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("status "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("400")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n          "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reject")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("call")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    request"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("send")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("ajax")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'GET'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/xxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("response")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("request")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br")])]),a("p",[t._v("Promise 姿势在调用方面：")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("ajax()")]),t._v(" 返回了一个含有"),a("code",[t._v(".then()")]),t._v("方法的对象")]),t._v(" "),a("li",[a("code",[t._v(".then()")]),t._v("方法接收两个参数，第一个是成功回调函数，第二个是失败回调函数，也都分别只能传一个参数")]),t._v(" "),a("li",[a("code",[t._v("return new Promise((resolve, reject)=>{})")]),t._v(" 背下来")])]),t._v(" "),a("h2",{attrs:{id:"★小结-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★小结-2"}},[t._v("#")]),t._v(" ★小结")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("return new Promise((resolve, reject)=>{})")])]),t._v(" "),a("li",[t._v("任务成功则调用"),a("code",[t._v("resolve(result)")])]),t._v(" "),a("li",[t._v("任务失败则调用"),a("code",[t._v("reject(error)")])]),t._v(" "),a("li",[t._v("resolve 和 reject 会再调用 success 和 fail 函数")]),t._v(" "),a("li",[t._v("使用"),a("code",[t._v(".then(success, fail)")]),t._v("传入成功和失败函数")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Promise",target:"_blank",rel:"noopener noreferrer"}},[t._v("Promise MDN"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("Promise 高级用法以后说")])]),t._v(" "),a("p",[t._v("目前我们封装的 ajax 还有一些缺点：")]),t._v(" "),a("ul",[a("li",[t._v("POST 无法上传数据，上传的数据应作为 "),a("code",[t._v("request.send()")]),t._v(" 的参数")]),t._v(" "),a("li",[t._v("不能设置请求头，"),a("code",[t._v("request.setRequestHeader(key, value)")])])]),t._v(" "),a("p",[t._v("解决方法：")]),t._v(" "),a("ul",[a("li",[t._v("使用 "),a("code",[t._v("jQuery.ajax")])]),t._v(" "),a("li",[t._v("使用 axios（比 jQuery 更有逼格）")]),t._v(" "),a("li",[t._v("花时间将 ajax 写到完美（精进）")])]),t._v(" "),a("h2",{attrs:{id:"★jquery-ajax"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★jquery-ajax"}},[t._v("#")]),t._v(" ★jQuery.ajax")]),t._v(" "),a("ul",[a("li",[t._v("已经非常完美\n"),a("ul",[a("li",[t._v("查看 "),a("a",{attrs:{href:"https://www.jquery123.com/jQuery.ajax/",target:"_blank",rel:"noopener noreferrer"}},[t._v("中文文档"),a("OutboundLink")],1),t._v(" / "),a("a",{attrs:{href:"https://api.jquery123.com/jQuery.ajax/",target:"_blank",rel:"noopener noreferrer"}},[t._v("英文文档"),a("OutboundLink")],1),t._v("，搜索 ajax，找到 "),a("code",[t._v("jQuery.ajax")])]),t._v(" "),a("li",[t._v("查看参数说明，阅读代码示例")]),t._v(" "),a("li",[t._v("看到 jQuery 的封装，便会感叹自己的封装是辣鸡")])])]),t._v(" "),a("li",[t._v("封装优点\n"),a("ul",[a("li",[t._v("支持更多形式的参数")]),t._v(" "),a("li",[t._v("支持 Promise")]),t._v(" "),a("li",[t._v("支持超多功能")])])]),t._v(" "),a("li",[t._v("无需掌握 jQuery.ajax\n"),a("ul",[a("li",[t._v("现在的专业前端都用 axios")]),t._v(" "),a("li",[t._v("写一篇博客罗列一下功能，然后就可以忘掉 jQuery 了")])])])]),t._v(" "),a("h2",{attrs:{id:"★axios"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★axios"}},[t._v("#")]),t._v(" ★Axios")]),t._v(" "),a("ul",[a("li",[t._v("目前最新的 AJAX 库\n"),a("ul",[a("li",[t._v("抄袭了 jQuery 的封装思路")]),t._v(" "),a("li",[t._v("查看 "),a("a",{attrs:{href:"http://www.axios-js.com/zh-cn/docs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("文档"),a("OutboundLink")],1),t._v(" 和方方的 "),a("a",{attrs:{href:"https://juejin.im/post/5a9cddb46fb9a028bc2d3c2f",target:"_blank",rel:"noopener noreferrer"}},[t._v("博客"),a("OutboundLink")],1),t._v("，以便快速了解 axios 的用法")]),t._v(" "),a("li",[t._v("推荐也通过写博客的方式来学习库")])])]),t._v(" "),a("li",[t._v("axios 高级用法\n"),a("ul",[a("li",[t._v("JSON 自动处理\n"),a("ul",[a("li",[t._v("axios 如果发现响应的 Content-Type 是 json")]),t._v(" "),a("li",[t._v("就会自动调用 JSON.parse")]),t._v(" "),a("li",[t._v("因此正确设置 Content-Type 是好习惯")])])]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/axios/axios#interceptors",target:"_blank",rel:"noopener noreferrer"}},[t._v("请求拦截器"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[t._v("可以在所有请求里加些东西，比如加查询参数")])])]),t._v(" "),a("li",[t._v("响应拦截器\n"),a("ul",[a("li",[t._v("可以在所有响应里加些东西，甚至修改内容")])])]),t._v(" "),a("li",[t._v("可生成不同实例（对象）\n"),a("ul",[a("li",[t._v("不同实例可以设置不同配置，以用于复杂场景")])])]),t._v(" "),a("li",[t._v("Promise 不可以取消请求，axios 通过其他方式可以取消")])])])]),t._v(" "),a("h2",{attrs:{id:"★总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★总结"}},[t._v("#")]),t._v(" ★总结")]),t._v(" "),a("ul",[a("li",[t._v("异步是什么：不能直接拿到结果")]),t._v(" "),a("li",[t._v("异步为什么用回调（或轮询）：为了拿到不能直接拿到的结果")]),t._v(" "),a("li",[t._v("回调的三个问题：参数名、地狱、错误处理")]),t._v(" "),a("li",[t._v("Promise 是什么：1976 年的一种设计模式")]),t._v(" "),a("li",[t._v("Promise 怎么用："),a("code",[t._v("return new Promise((resolve, reject)=>{})")])]),t._v(" "),a("li",[t._v("Axios 怎么用：bootcdn 引用后发请求试试")])]),t._v(" "),a("p",[t._v("初级学接口，中级学封装，高级造轮子。")]),t._v(" "),a("p",[t._v("Promise 是前端解决异步问题的统一解决方案，因此面试一定会问！")]),t._v(" "),a("hr"),t._v(" "),a("ul",[a("li",[t._v("关于异步\n"),a("ul",[a("li",[t._v("如果 JS 不能直接拿到一个函数的结果，可以先去执行其他代码，等到有结果了再去取结果，这就是异步")]),t._v(" "),a("li",[t._v("异步的结果可以通过轮询获取，轮询就是定时去询问是否出结果")]),t._v(" "),a("li",[t._v("异步的结果可以通过回调获取，一般结果会被作为回调的第一个参数")]),t._v(" "),a("li",[t._v("异步的好处是可以把用来等待的时间拿去做别的事")])])]),t._v(" "),a("li",[t._v("关于回调\n"),a("ul",[a("li",[t._v("满足某些条件的函数才能被称为回调，比如写一个函数 A，传给另一个函数 B 调用，那么函数 A 就是回调")]),t._v(" "),a("li",[t._v("回调不一定用于异步任务，也可以用于同步任务")]),t._v(" "),a("li",[t._v("有时也可以将回调传给一个对象，如 "),a("code",[t._v("request.onreadystatechange")]),t._v("，等待浏览器来调用")])])]),t._v(" "),a("li",[t._v("关于 Promise\n"),a("ul",[a("li",[t._v("Promise 不是前端发明的")]),t._v(" "),a("li",[t._v("Promise 是目前前端解决异步问题的统一方案")]),t._v(" "),a("li",[a("code",[t._v("window.Promise")]),t._v(" 是一个用于构造 Promise 对象的全局函数")]),t._v(" "),a("li",[t._v("使用 "),a("code",[t._v("return new Promise((resolve, reject)=>{})")]),t._v(" 即可构造一个 Promise 对象")]),t._v(" "),a("li",[t._v("构造出来的 Promise 对象含有一个"),a("code",[t._v(".then()")]),t._v(" 函数属性")]),t._v(" "),a("li",[a("code",[t._v("resovle")]),t._v(" 和 "),a("code",[t._v("reject")]),t._v(" 可以改成任何其他名字而不影响使用，但一般都叫这个名字")]),t._v(" "),a("li",[t._v("异步任务成功时调用 resolve，失败时调用 reject")]),t._v(" "),a("li",[t._v("resolve 和 reject 都只接收一个参数")]),t._v(" "),a("li",[t._v("resolve 和 reject 并不是"),a("code",[t._v(".then(success(){},fail(){})")]),t._v(" 里边的 success 和 fail，resolve 会调用 success，reject 会调用 fail -> 类似传给"),a("code",[t._v("setTimeout")]),t._v("的回调函数！")])])]),t._v(" "),a("li",[t._v("关于 Axios\n"),a("ul",[a("li",[t._v("Axios 是一个专门用于操作 AJAX 的库")]),t._v(" "),a("li",[a("code",[t._v("axios.get('/xxx')")]),t._v("：返回一个 Promise 对象")]),t._v(" "),a("li",[a("code",[t._v("axios.get('/xxx').then(s,f)")]),t._v("：在请求成功时调用 "),a("code",[t._v("s")]),t._v("，失败时调用 "),a("code",[t._v("f")])])])])]),t._v(" "),a("h2",{attrs:{id:"★了解更多"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★了解更多"}},[t._v("#")]),t._v(" ★了解更多")]),t._v(" "),a("p",[t._v("➹："),a("a",{attrs:{href:"https://lichangwei.github.io/2017/06/30/callback-hell-and-async-program/",target:"_blank",rel:"noopener noreferrer"}},[t._v("【Node 系列】回调地狱和异步编程 - 飞鹰走码"),a("OutboundLink")],1)]),t._v(" "),a("h2",{attrs:{id:"★总结-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★总结-2"}},[t._v("#")]),t._v(" ★总结")]),t._v(" "),a("ul",[a("li",[t._v("文章的作者也是看看芳芳的视频学习，我也是看看芳芳的视频学习，但他总结的比我要好，比较简练，说白了，就是你得知道自己要明白什么……")])]),t._v(" "),a("h2",{attrs:{id:"★q-a"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#★q-a"}},[t._v("#")]),t._v(" ★Q&A")]),t._v(" "),a("h3",{attrs:{id:"_1-为什么不用原生-ajax-发请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-为什么不用原生-ajax-发请求"}},[t._v("#")]),t._v(" 1）为什么不用原生 AJAX 发请求？")]),t._v(" "),a("p",[t._v("因为不同的浏览器平台对 AJAX 的实现并不相同，所以你用原生 AJAX 发送请求的话，就不得不考虑代码的兼容性问题，而写出这样的代码，显然并不容易啊！")]),t._v(" "),a("p",[t._v("而 jQuery 团队为我们解决了这个难题，我们只需要一行简单的代码，就可以实现 AJAX 功能。")]),t._v(" "),a("p",[t._v("➹："),a("a",{attrs:{href:"https://www.twle.cn/l/yufei/jquery/jquery-basic-ajax-intro.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("jQuery AJAX 简介 - jQuery 基础教程 - 简单教程，简单编程"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("➹："),a("a",{attrs:{href:"https://www.cnblogs.com/qdhxhz/p/12337724.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("【jQuery】(8)---jquery Ajax - 雨点的名字 - 博客园"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("➹："),a("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/22564745",target:"_blank",rel:"noopener noreferrer"}},[t._v("「每日一题」AJAX 是什么？ - 知乎"),a("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=e.exports}}]);